<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for node-npmtest-node-forge/node_modules/node-forge/lib/prime.worker.js</title>
    <meta charset="utf-8">
    <style>
        body, html {
            margin:0; padding: 0;
        }
        body {
            font-family: Arial, Helvetica;
            font-size: 10pt;
        }
        div.header, div.footer {
            background: #eee;
            padding: 1em;
        }
        div.header {
            height: 160px;
            padding: 0 1em 0 1em;
            z-index: 100;
            position: fixed;
            top: 0;
            border-bottom: 1px solid #666;
            width: 100%;
        }
        div.footer {
            border-top: 1px solid #666;
        }
        div.body {
            margin-top: 170px;
        }
        div.meta {
            font-size: 90%;
            text-align: center;
        }
        h1, h2, h3 {
            font-weight: normal;
        }
        h1 {
            font-size: 12pt;
        }
        h2 {
            font-size: 10pt;
        }
        pre {
            font-family: Menlo, Monaco, Consolas, Courier New, monospace;
            margin: 0;
            padding: 0;
            font-size: 14px;
            tab-size: 2;
        }

        div.path { font-size: 110%; }
        div.path a:link, div.path a:visited { color: #000; }
        table.coverage { border-collapse: collapse; margin:0; padding: 0 }

        table.coverage td {
            margin: 0;
            padding: 0;
            color: #111;
            vertical-align: top;
        }
        table.coverage td.line-count {
            width: 50px;
            text-align: right;
            padding-right: 5px;
        }
        table.coverage td.line-coverage {
            color: #777 !important;
            text-align: right;
            border-left: 1px solid #666;
            border-right: 1px solid #666;
        }

        table.coverage td.text {
        }

        table.coverage td span.cline-any {
            display: inline-block;
            padding: 0 5px;
            width: 40px;
        }
        table.coverage td span.cline-neutral {
            background: #eee;
        }
        table.coverage td span.cline-yes {
            background: #b5d592;
            color: #999;
        }
        table.coverage td span.cline-no {
            background: #fc8c84;
        }

        .cstat-yes { color: #111; }
        .cstat-no { background: #fc8c84; color: #111; }
        .fstat-no { background: #ffc520; color: #111 !important; }
        .cbranch-no { background:  yellow !important; color: #111; }

        .cstat-skip { background: #ddd; color: #111; }
        .fstat-skip { background: #ddd; color: #111 !important; }
        .cbranch-skip { background: #ddd !important; color: #111; }

        .missing-if-branch {
            display: inline-block;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: black;
            color: yellow;
        }

        .skip-if-branch {
            display: none;
            margin-right: 10px;
            position: relative;
            padding: 0 4px;
            background: #ccc;
            color: white;
        }

        .missing-if-branch .typ, .skip-if-branch .typ {
            color: inherit !important;
        }

        .entity, .metric { font-weight: bold; }
        .metric { display: inline-block; border: 1px solid #333; padding: 0.3em; background: white; }
        .metric small { font-size: 80%; font-weight: normal; color: #666; }

        div.coverage-summary table { border-collapse: collapse; margin: 3em; font-size: 110%; }
        div.coverage-summary td, div.coverage-summary table  th { margin: 0; padding: 0.25em 1em; border-top: 1px solid #666; border-bottom: 1px solid #666; }
        div.coverage-summary th { text-align: left; border: 1px solid #666; background: #eee; font-weight: normal; }
        div.coverage-summary th.file { border-right: none !important; }
        div.coverage-summary th.pic { border-left: none !important; text-align: right; }
        div.coverage-summary th.pct { border-right: none !important; }
        div.coverage-summary th.abs { border-left: none !important; text-align: right; }
        div.coverage-summary td.pct { text-align: right; border-left: 1px solid #666; }
        div.coverage-summary td.abs { text-align: right; font-size: 90%; color: #444; border-right: 1px solid #666; }
        div.coverage-summary td.file { text-align: right; border-left: 1px solid #666; white-space: nowrap;  }
        div.coverage-summary td.pic { min-width: 120px !important;  }
        div.coverage-summary a:link { color: #000; }
        div.coverage-summary a:visited { color: #333; }
        div.coverage-summary tfoot td { border-top: 1px solid #666; }

        div.coverage-summary .yui3-datatable-sort-indicator, div.coverage-summary .dummy-sort-indicator {
            height: 10px;
            width: 7px;
            display: inline-block;
            margin-left: 0.5em;
        }
        div.coverage-summary .yui3-datatable-sort-indicator {
            background: no-repeat scroll 0 0 transparent;
        }
        div.coverage-summary .yui3-datatable-sorted .yui3-datatable-sort-indicator {
            background-position: 0 -20px;
        }
        div.coverage-summary .yui3-datatable-sorted-desc .yui3-datatable-sort-indicator {
            background-position: 0 -10px;
        }

        .high { background: #b5d592 !important; }
        .medium { background: #ffe87c !important; }
        .low { background: #fc8c84 !important; }

        span.cover-fill, span.cover-empty {
            display:inline-block;
            border:1px solid #444;
            background: white;
            height: 12px;
        }
        span.cover-fill {
            background: #ccc;
            border-right: 1px solid #444;
        }
        span.cover-empty {
            background: white;
            border-left: none;
        }
        span.cover-full {
            border-right: none !important;
        }
        pre.prettyprint {
            border: none !important;
            padding: 0 !important;
            margin: 0 !important;
        }
        .com { color: #999 !important; }
        .ignore-none { color: #999; font-weight: normal; }

    </style>
</head>
<body>
<div class="header low">
    <h1 style="font-weight: bold;">
        <a href="https://github.com/npmtest/node-npmtest-node-forge">npmtest-node-forge (v0.0.2)</a>
    </h1>
    <h1>Code coverage report for <span class="entity">node-npmtest-node-forge/node_modules/node-forge/lib/prime.worker.js</span></h1>
    <h2>
        
        Statements: <span class="metric">15.12% <small>(13 / 86)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Branches: <span class="metric">0% <small>(0 / 42)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Functions: <span class="metric">0% <small>(0 / 7)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        
        Lines: <span class="metric">17.33% <small>(13 / 75)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../../../../index.html">All files</a> &#187; <a href="index.html">node-npmtest-node-forge/node_modules/node-forge/lib/</a> &#187; prime.worker.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170</td><td class="line-coverage"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">/**
 * RSA Key Generation Worker.
 *
 * @author Dave Longley
 *
 * Copyright (c) 2013 Digital Bazaar, Inc.
 */
// worker is built using CommonJS syntax to include all code in one worker file
//importScripts('jsbn.js');
var forge = require('./forge');
require('./jsbn');
&nbsp;
// prime constants
var LOW_PRIMES = [2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];
var LP_LIMIT = (1 &lt;&lt; 26) / LOW_PRIMES[LOW_PRIMES.length - 1];
&nbsp;
var BigInteger = forge.jsbn.BigInteger;
var BIG_TWO = new BigInteger(null);
BIG_TWO.fromInt(2);
&nbsp;
self.addEventListener('message', <span class="fstat-no" title="function not covered" >function(e) {</span>
<span class="cstat-no" title="statement not covered" >  var result = findPrime(e.data);</span>
<span class="cstat-no" title="statement not covered" >  self.postMessage(result);</span>
});
&nbsp;
// start receiving ranges to check
<span class="cstat-no" title="statement not covered" >self.postMessage({found: false});</span>
&nbsp;
// primes are 30k+i for i = 1, 7, 11, 13, 17, 19, 23, 29
<span class="cstat-no" title="statement not covered" >var GCD_30_DELTA = [6, 4, 2, 4, 2, 4, 6, 2];</span>
&nbsp;
<span class="fstat-no" title="function not covered" >function findPrime(data) {</span>
  // TODO: abstract based on data.algorithm (PRIMEINC vs. others)
&nbsp;
  // create BigInteger from given random bytes
<span class="cstat-no" title="statement not covered" >  var num = new BigInteger(data.hex, 16);</span>
&nbsp;
  /* Note: All primes are of the form 30k+i for i &lt; 30 and gcd(30, i)=1. The
    number we are given is always aligned at 30k + 1. Each time the number is
    determined not to be prime we add to get to the next 'i', eg: if the number
    was at 30k + 1 we add 6. */
<span class="cstat-no" title="statement not covered" >  var deltaIdx = 0;</span>
&nbsp;
  // find nearest prime
<span class="cstat-no" title="statement not covered" >  var workLoad = data.workLoad;</span>
<span class="cstat-no" title="statement not covered" >  for(var i = 0; i &lt; workLoad; ++i) {</span>
    // do primality test
<span class="cstat-no" title="statement not covered" >    if(isProbablePrime(num)) {</span>
<span class="cstat-no" title="statement not covered" >      return {found: true, prime: num.toString(16)};</span>
    }
    // get next potential prime
<span class="cstat-no" title="statement not covered" >    num.dAddOffset(GCD_30_DELTA[deltaIdx++ % 8], 0);</span>
  }
&nbsp;
<span class="cstat-no" title="statement not covered" >  return {found: false};</span>
}
&nbsp;
<span class="fstat-no" title="function not covered" >function isProbablePrime(n) {</span>
  // divide by low primes, ignore even checks, etc (n alread aligned properly)
<span class="cstat-no" title="statement not covered" >  var i = 1;</span>
<span class="cstat-no" title="statement not covered" >  while(i &lt; LOW_PRIMES.length) {</span>
<span class="cstat-no" title="statement not covered" >    var m = LOW_PRIMES[i];</span>
<span class="cstat-no" title="statement not covered" >    var j = i + 1;</span>
<span class="cstat-no" title="statement not covered" >    while(j &lt; LOW_PRIMES.length &amp;&amp; m &lt; LP_LIMIT) {</span>
<span class="cstat-no" title="statement not covered" >      m *= LOW_PRIMES[j++];</span>
    }
<span class="cstat-no" title="statement not covered" >    m = n.modInt(m);</span>
<span class="cstat-no" title="statement not covered" >    while(i &lt; j) {</span>
<span class="cstat-no" title="statement not covered" >      if(m % LOW_PRIMES[i++] === 0) {</span>
<span class="cstat-no" title="statement not covered" >        return false;</span>
      }
    }
  }
<span class="cstat-no" title="statement not covered" >  return runMillerRabin(n);</span>
}
&nbsp;
// HAC 4.24, Miller-Rabin
<span class="fstat-no" title="function not covered" >function runMillerRabin(n) {</span>
  // n1 = n - 1
<span class="cstat-no" title="statement not covered" >  var n1 = n.subtract(BigInteger.ONE);</span>
&nbsp;
  // get s and d such that n1 = 2^s * d
<span class="cstat-no" title="statement not covered" >  var s = n1.getLowestSetBit();</span>
<span class="cstat-no" title="statement not covered" >  if(s &lt;= 0) {</span>
<span class="cstat-no" title="statement not covered" >    return false;</span>
  }
<span class="cstat-no" title="statement not covered" >  var d = n1.shiftRight(s);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >  var k = _getMillerRabinTests(n.bitLength());</span>
<span class="cstat-no" title="statement not covered" >  var prng = getPrng();</span>
<span class="cstat-no" title="statement not covered" >  var a;</span>
<span class="cstat-no" title="statement not covered" >  for(var i = 0; i &lt; k; ++i) {</span>
    // select witness 'a' at random from between 1 and n - 1
<span class="cstat-no" title="statement not covered" >    do {</span>
<span class="cstat-no" title="statement not covered" >      a = new BigInteger(n.bitLength(), prng);</span>
    } while(a.compareTo(BigInteger.ONE) &lt;= 0 || a.compareTo(n1) &gt;= 0);
&nbsp;
    /* See if 'a' is a composite witness. */
&nbsp;
    // x = a^d mod n
<span class="cstat-no" title="statement not covered" >    var x = a.modPow(d, n);</span>
&nbsp;
    // probably prime
<span class="cstat-no" title="statement not covered" >    if(x.compareTo(BigInteger.ONE) === 0 || x.compareTo(n1) === 0) {</span>
<span class="cstat-no" title="statement not covered" >      continue;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    var j = s;</span>
<span class="cstat-no" title="statement not covered" >    while(--j) {</span>
      // x = x^2 mod a
<span class="cstat-no" title="statement not covered" >      x = x.modPowInt(2, n);</span>
&nbsp;
      // 'n' is composite because no previous x == -1 mod n
<span class="cstat-no" title="statement not covered" >      if(x.compareTo(BigInteger.ONE) === 0) {</span>
<span class="cstat-no" title="statement not covered" >        return false;</span>
      }
      // x == -1 mod n, so probably prime
<span class="cstat-no" title="statement not covered" >      if(x.compareTo(n1) === 0) {</span>
<span class="cstat-no" title="statement not covered" >        break;</span>
      }
    }
&nbsp;
    // 'x' is first_x^(n1/2) and is not +/- 1, so 'n' is not prime
<span class="cstat-no" title="statement not covered" >    if(j === 0) {</span>
<span class="cstat-no" title="statement not covered" >      return false;</span>
    }
  }
&nbsp;
<span class="cstat-no" title="statement not covered" >  return true;</span>
}
&nbsp;
// get pseudo random number generator
<span class="fstat-no" title="function not covered" >function getPrng() {</span>
  // create prng with api that matches BigInteger secure random
<span class="cstat-no" title="statement not covered" >  return {</span>
    // x is an array to fill with bytes
    nextBytes: <span class="fstat-no" title="function not covered" >function(x) {</span>
<span class="cstat-no" title="statement not covered" >      for(var i = 0; i &lt; x.length; ++i) {</span>
<span class="cstat-no" title="statement not covered" >        x[i] = Math.floor(Math.random() * 0xFF);</span>
      }
    }
  };
}
&nbsp;
/**
 * Returns the required number of Miller-Rabin tests to generate a
 * prime with an error probability of (1/2)^80.
 *
 * See Handbook of Applied Cryptography Chapter 4, Table 4.4.
 *
 * @param bits the bit size.
 *
 * @return the required number of iterations.
 */
<span class="fstat-no" title="function not covered" >function _getMillerRabinTests(bits) {</span>
<span class="cstat-no" title="statement not covered" >  if(bits &lt;= 100) <span class="cstat-no" title="statement not covered" >return 27;</span></span>
<span class="cstat-no" title="statement not covered" >  if(bits &lt;= 150) <span class="cstat-no" title="statement not covered" >return 18;</span></span>
<span class="cstat-no" title="statement not covered" >  if(bits &lt;= 200) <span class="cstat-no" title="statement not covered" >return 15;</span></span>
<span class="cstat-no" title="statement not covered" >  if(bits &lt;= 250) <span class="cstat-no" title="statement not covered" >return 12;</span></span>
<span class="cstat-no" title="statement not covered" >  if(bits &lt;= 300) <span class="cstat-no" title="statement not covered" >return 9;</span></span>
<span class="cstat-no" title="statement not covered" >  if(bits &lt;= 350) <span class="cstat-no" title="statement not covered" >return 8;</span></span>
<span class="cstat-no" title="statement not covered" >  if(bits &lt;= 400) <span class="cstat-no" title="statement not covered" >return 7;</span></span>
<span class="cstat-no" title="statement not covered" >  if(bits &lt;= 500) <span class="cstat-no" title="statement not covered" >return 6;</span></span>
<span class="cstat-no" title="statement not covered" >  if(bits &lt;= 600) <span class="cstat-no" title="statement not covered" >return 5;</span></span>
<span class="cstat-no" title="statement not covered" >  if(bits &lt;= 800) <span class="cstat-no" title="statement not covered" >return 4;</span></span>
<span class="cstat-no" title="statement not covered" >  if(bits &lt;= 1250) <span class="cstat-no" title="statement not covered" >return 3;</span></span>
<span class="cstat-no" title="statement not covered" >  return 2;</span>
}
&nbsp;
&nbsp;</pre></td></tr>
</table></pre>
</div>
<div class="footer">
    <div class="meta">Generated by <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a> at Wed Apr 19 2017 07:32:48 GMT+0000 (UTC)</div>
</div>
</body>
</html>
